{
    "sourceFile": "src/app/authentication/otp-submition/otp-submition.component.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 10,
            "patches": [
                {
                    "date": 1738220926356,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1738220985839,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,9 +48,8 @@\n \r\n           const addressString = `${address}, ${city}, ${state}, ${zip}, ${country}`;\r\n \r\n           localStorage.setItem('userAddress', addressString);\r\n-          console.log(addressString);\r\n       },\r\n       error: (error: any) => {\r\n         this.errorMessage = error.error.errorMessages || 'An error occurred';\r\n         alert(this.errorMessage);\r\n"
                },
                {
                    "date": 1738230362881,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,9 +11,9 @@\n   styleUrl: './otp-submition.component.scss'\r\n })\r\n \r\n export class OtpSubmitionComponent implements OnInit {\r\n-  mobileNumber: string = '';\r\n+  mobileNumber = String(localStorage.getItem('mobile-otp'));\r\n   otp: string = '';\r\n   isWhatsAppChecked: boolean = false;\r\n   isFormValid: boolean = false;\r\n \r\n@@ -28,11 +28,11 @@\n     private route: ActivatedRoute,\r\n     private router: Router) {}\r\n \r\n   ngOnInit() {\r\n-    this.route.queryParams.subscribe((params) => {\r\n-      this.mobileNumber = params['key'];\r\n-    });\r\n+    // this.route.queryParams.subscribe((params) => {\r\n+    //   this.mobileNumber = params['key'];\r\n+    // });\r\n \r\n     this.startTimer();\r\n   }\r\n \r\n"
                },
                {
                    "date": 1738230421508,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,6 @@\n import { Component, OnInit } from '@angular/core';\r\n import { SharedModule } from '../../shared/shared.module';\r\n-import { ActivatedRoute, Router } from '@angular/router';\r\n import { LoginService } from '../login.service';\r\n \r\n @Component({\r\n   selector: 'app-otp-submition',\r\n@@ -24,16 +23,11 @@\n   errorMessage: string = '';\r\n \r\n   constructor(\r\n     private loginService: LoginService,\r\n-    private route: ActivatedRoute,\r\n     private router: Router) {}\r\n \r\n   ngOnInit() {\r\n-    // this.route.queryParams.subscribe((params) => {\r\n-    //   this.mobileNumber = params['key'];\r\n-    // });\r\n-\r\n     this.startTimer();\r\n   }\r\n \r\n   onSubmitOtp() {\r\n"
                },
                {
                    "date": 1738230434917,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n import { Component, OnInit } from '@angular/core';\r\n import { SharedModule } from '../../shared/shared.module';\r\n+import { Router } from '@angular/router';\r\n import { LoginService } from '../login.service';\r\n \r\n @Component({\r\n   selector: 'app-otp-submition',\r\n"
                },
                {
                    "date": 1738237303952,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import { Component, OnInit } from '@angular/core';\r\n import { SharedModule } from '../../shared/shared.module';\r\n-import { Router } from '@angular/router';\r\n+import { Router, RouterLink } from '@angular/router';\r\n import { LoginService } from '../login.service';\r\n \r\n @Component({\r\n   selector: 'app-otp-submition',\r\n"
                },
                {
                    "date": 1738237314618,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n \r\n @Component({\r\n   selector: 'app-otp-submition',\r\n   standalone: true,\r\n-  imports: [SharedModule],\r\n+  imports: [SharedModule, RouterLink],\r\n   templateUrl: './otp-submition.component.html',\r\n   styleUrl: './otp-submition.component.scss'\r\n })\r\n \r\n"
                },
                {
                    "date": 1738305168172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,8 +37,10 @@\n         if (response.isSuccess = 'true' )\r\n           this.router.navigate(['/dashboard'], { queryParams: { key: response.result.token } });\r\n           localStorage.setItem('authToken', response.result.token);\r\n           localStorage.setItem('username', response.result?.user.firstName);\r\n+          localStorage.setItem('username', response.result?.user.firstName);\r\n+          localStorage.setItem('username', response.result?.user.firstName);\r\n \r\n           const { address, city, state, zip, country } = response.result?.user;\r\n \r\n           const addressString = `${address}, ${city}, ${state}, ${zip}, ${country}`;\r\n"
                },
                {
                    "date": 1738305210497,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,10 +37,10 @@\n         if (response.isSuccess = 'true' )\r\n           this.router.navigate(['/dashboard'], { queryParams: { key: response.result.token } });\r\n           localStorage.setItem('authToken', response.result.token);\r\n           localStorage.setItem('username', response.result?.user.firstName);\r\n-          localStorage.setItem('username', response.result?.user.firstName);\r\n-          localStorage.setItem('username', response.result?.user.firstName);\r\n+          localStorage.setItem('usermobile', response.result?.user.mobile);\r\n+          localStorage.setItem('useremail', response.result?.user.email);\r\n \r\n           const { address, city, state, zip, country } = response.result?.user;\r\n \r\n           const addressString = `${address}, ${city}, ${state}, ${zip}, ${country}`;\r\n"
                },
                {
                    "date": 1738307185327,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,8 +49,9 @@\n       },\r\n       error: (error: any) => {\r\n         this.errorMessage = error.error.errorMessages || 'An error occurred';\r\n         alert(this.errorMessage);\r\n+        window.location.reload();\r\n       }\r\n     });\r\n   }\r\n \r\n"
                },
                {
                    "date": 1738308329496,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,9 +49,9 @@\n       },\r\n       error: (error: any) => {\r\n         this.errorMessage = error.error.errorMessages || 'An error occurred';\r\n         alert(this.errorMessage);\r\n-        window.location.reload();\r\n+        this.otp = '';\r\n       }\r\n     });\r\n   }\r\n \r\n"
                }
            ],
            "date": 1738220926356,
            "name": "Commit-0",
            "content": "import { Component, OnInit } from '@angular/core';\r\nimport { SharedModule } from '../../shared/shared.module';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { LoginService } from '../login.service';\r\n\r\n@Component({\r\n  selector: 'app-otp-submition',\r\n  standalone: true,\r\n  imports: [SharedModule],\r\n  templateUrl: './otp-submition.component.html',\r\n  styleUrl: './otp-submition.component.scss'\r\n})\r\n\r\nexport class OtpSubmitionComponent implements OnInit {\r\n  mobileNumber: string = '';\r\n  otp: string = '';\r\n  isWhatsAppChecked: boolean = false;\r\n  isFormValid: boolean = false;\r\n\r\n  isResendDisabled: boolean = true;\r\n  timer: number = 60;\r\n  interval: any;\r\n  responseMessage: string = '';\r\n  errorMessage: string = '';\r\n\r\n  constructor(\r\n    private loginService: LoginService,\r\n    private route: ActivatedRoute,\r\n    private router: Router) {}\r\n\r\n  ngOnInit() {\r\n    this.route.queryParams.subscribe((params) => {\r\n      this.mobileNumber = params['key'];\r\n    });\r\n\r\n    this.startTimer();\r\n  }\r\n\r\n  onSubmitOtp() {\r\n    this.loginService.verifyOtp(this.mobileNumber, this.otp).subscribe({\r\n      next: (response: any) => {\r\n        if (response.isSuccess = 'true' )\r\n          this.router.navigate(['/dashboard'], { queryParams: { key: response.result.token } });\r\n          localStorage.setItem('authToken', response.result.token);\r\n          localStorage.setItem('username', response.result?.user.firstName);\r\n\r\n          const { address, city, state, zip, country } = response.result?.user;\r\n\r\n          const addressString = `${address}, ${city}, ${state}, ${zip}, ${country}`;\r\n\r\n          localStorage.setItem('userAddress', addressString);\r\n          console.log(addressString);\r\n      },\r\n      error: (error: any) => {\r\n        this.errorMessage = error.error.errorMessages || 'An error occurred';\r\n        alert(this.errorMessage);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  /////************ */\r\n\r\n  allowOnlyNumbers(event: KeyboardEvent): void {\r\n    const charCode = event.key.charCodeAt(0);\r\n    if (charCode < 48 || charCode > 57) {\r\n      event.preventDefault();\r\n    }\r\n  }\r\n\r\n  validateForm(): void {\r\n    this.isFormValid = this.otp.trim().length >= 4\r\n  }\r\n\r\n  startTimer(): void {\r\n    this.isResendDisabled = true;\r\n    this.timer = 60;\r\n\r\n    this.interval = setInterval(() => {\r\n      this.timer--;\r\n      if (this.timer === 0) {\r\n        this.isResendDisabled = false;\r\n        clearInterval(this.interval);\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  resendOtp(): void {\r\n    console.log('Resend OTP API call triggered for mobile:', this.mobileNumber);\r\n    this.startTimer();\r\n  }\r\n}\r\n"
        }
    ]
}